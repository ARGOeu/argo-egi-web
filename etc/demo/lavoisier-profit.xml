<config xmlns="http://software.in2p3.fr/lavoisier/config.xsd" version="14">
    <view name="profit">
        <argument name="file">input.csv</argument>
        <connector type="HTTPConnector">
            <parameter name="url" eval="concat('http://software.in2p3.fr/lavoisier/',$file)"/>
        </connector>
        <serializer type="CSVSerializer">
            <parameter name="header">true</parameter>
        </serializer>
        <processors xmlns:ns_0="http://software.in2p3.fr/lavoisier/rendering.xsd">
            <processor match="/ns_0:rendering/ns_0:rows/ns_0:row/ns_0:column[@label='Profit']/text()" type="SelectProcessor"/>
        </processors>
        <renderers>
            <renderer type="JSONRenderer">
                <parameter name="text_as_pair">false</parameter>
            </renderer>
            <renderer type="CsvRenderer">
                <parameter name="separator">;</parameter>
            </renderer>
            <renderer type="HTMLRenderer">
                <parameter name="template">html/profit.html</parameter>
            </renderer>
        </renderers>
    </view>
    <view name="profit_invoices">
        <connector type="StringConnector">
            <parameter name="content">{"invoices":["128","243","187","306","247","203"]}</parameter>
        </connector>
        <serializer type="JSONSerializer"/>
        <processors>
            <processor type="InsertProcessor" match="/object/invoices/item">
                <parameter name="nodes" eval="new_attribute('profit', view('profit')/*/*[position()=position(match())])"/>
            </processor>
        </processors>
        <pre-renderers>
            <row foreach="/object/invoices/item">
                <column>@position</column>
                <column unit="$">@profit</column>
                <column unit="nb" label="invoices">text()</column>
            </row>
        </pre-renderers>
        <renderers>
            <renderer type="CsvRenderer">
                <parameter name="separator">;</parameter>
            </renderer>
        </renderers>
    </view>
</config>