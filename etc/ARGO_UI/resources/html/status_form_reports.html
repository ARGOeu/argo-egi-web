<!DOCTYPE html>
<html xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd"
      xmlns:tpl="http://software.in2p3.fr/lavoisier/template.xsd"
      tpl:extends="http://localhost:8080/lavoisier?accept=html"
      tpl:parameter.min=""
      tpl:parameter.max="">


<body>
<!-- Right side column. Contains the navbar and content of the page -->
<div id="wrapper">

<aside class="right-side" id="right-side">
    <!-- Content Header (Page header) -->
    <section class="content-header" id="content-header">
        <h1>
            Status Reports
            <small>Fill the form to access to the report</small>
        </h1>

    </section>

    <!-- Main content -->
    <section class="content" id="content">
        <div id="id_content" class="hidden"></div>



            <div class="box box-primary">

                <div class="row" style="margin:20px;padding:20px">

                    <div class="box  col-md-3" style="margin:20px;padding:20px;height:400px ">

                        <div class="box-header"><H3 class="box-title"> <label> <i class="fa fa-calendar"> </i>   Date range:</label></H3></div>
                        <div class="box-body">
                            <div class="range">


                                <!--<input  id="reportrange" type="text" /><span></span><br/>-->

                                <input type="radio" name="range" class="range" value="data_status_report_today" checked="true"/> Today <br/>
                                <input type="radio" name="range" class="range"  value="data_status_report_last_day"/> Previous day<br/>
                                <input type="radio" name="range" class="range"  value="data_status_report_lastweek"/> Last 7 days<br/>
                                <input type="radio" name="range" class="range"  value="data_status_report_lastmonth"/> Last 30 days<br/>
                                <input type="radio" name="range" class="range" value="data_status_report_3lastmonth"/> Last 3 months<br/>
                            </div><!-- /.input group -->
                            </div>


                        </div>




                    <div class="box  col-md-3 " style="margin:20px;padding:20px;height:400px">

                        <div class="box-header"><H3 class="box-title"> <label> <i class="fa fa-globe"> </i>   Entity :</label></H3></div>

                        <div class="box-body">

                            <div class="form-group ">



                                <label>NGI </label>
                                <input type="text" style="margin-left:20px" name="ngi" id="filters-ngi" placeholder="Enter Search "/><br/>




                                <label>SITE </label>
                                <input type="text" style="margin-left:20px" name="site" id="filters-site" placeholder="Enter Search "/><br/>


                                <label>SERVICE TYPE </label>

                                <input type="text" style="margin-left:20px" name="sf" id="filters-sf" placeholder="Enter Search "/><br/>




                                <label>HOST </label>
                                <input type="text" style="margin-left:20px" name="host" id="filters-host" placeholder="Enter Search "/>


                            </div>
                        </div>
                    </div>



                    <div class="box  col-md-3 " style="margin:20px;padding:20px;height:400px">

                        <div class="box-header"><H3 class="box-title">Profiles</H3></div>

                        <div class="box-body">

                            <div class="form-group profile">


                                <input  tpl:foreach="/root/profile" tpl:with-order="@namespace" type="radio" class="profile" name="profile" value="{{concat(@namespace,'-',@name)}}" checked="true"> {{concat(@namespace,'-',@name)}} <br/></input>



                            </div>
                        </div>
                    </div>



                </div>



                <div class="row" style="margin:30px;padding:20px">
                    <input type="submit" class="btn btn-primary offset1" id="buttonAR" value="Generate Reports"/>
                </div>

            </div>




            <div class="hidden" id="listNgi" tpl:foreach="/root/ngis">{{text()}}</div>
            <div class="hidden" id="listSite" tpl:foreach="/root/sites">{{text()}}</div>
        <div  id="listHost"  class="hidden"  tpl:foreach="/root/hosts">{{text()}}</div>

            <div    id="listSf" class="hidden">
                <div tpl:foreach="root/profile/AND/OR/Group">{{@service_flavor}}</div>
                </div>


        <script src="/resource/ARGO_UI/resources/js/plugins/daterangepicker/daterangepicker.js" type="text/javascript"></script>


        <script>
<!--
            $(document).ready(function ($) {




                // Variable initialisation for the autocomplete
                var availableNgis =  $("#listNgi").text();
                var availableSites =   $("#listSite").text();
                var availableHosts =   $("#listHost").text();


                var tabavailableNgis=  availableNgis.split(',');
                var tabavailableSite= availableSites.split(',');
                var tabavailableHost= availableHosts.split(',');
                tabavailableHost.shift();

                var tabavailableHostNgi= [];
                var tabavailableHostSite= [];
                var tabavailableHostList= [];
                var tabavailableHostHost= [];
                var tabavailableHostSf= [];

                var tabavailableSf= [];

                $.each(tabavailableHost, function( index, value ) {
                   var tabsHost= value.split('___');

                    tabavailableHostNgi[tabsHost[2] + ' (' + tabsHost[3] + ')']=tabsHost[0];
                    tabavailableHostSite[tabsHost[2] + ' (' + tabsHost[3] + ')']=tabsHost[1];
                    tabavailableHostHost[tabsHost[2] + ' (' + tabsHost[3] + ')']=tabsHost[2];
                    tabavailableHostList.push(tabsHost[2] + ' (' + tabsHost[3] + ')');
                    tabavailableHostSf[tabsHost[2] + ' (' + tabsHost[3] + ')']=tabsHost[3];
                });


                var divSf= document.getElementById('listSf').getElementsByTagName('div');


                for (i=0; i<divSf.length; i++) {
                    tabavailableSf.push(divSf[i].textContent);
                }



                $("#filters-ngi").autocomplete({
                    search:true,
                    source: tabavailableNgis,
                    TextHint : "Enter search or Double click to have the whole list"

                });

                $("#filters-site").autocomplete({
                    source: tabavailableSite,
                    autoFocus: true
                });



                $("#filters-host").autocomplete({
                    source: tabavailableHostList,
                    autoFocus: true
                });

                $("#filters-sf").autocomplete({
                    source: tabavailableSf,
                    autoFocus: true
                });



                $("#buttonAR").click(function () {



                    var FormValid=true;

                    // NGI or Site should be filled
                    if ( ($('input[id=filters-ngi]').val()  && $('input[id=filters-site]').val() && $('input[id=filters-host]').val()) || ($('input[id=filters-ngi]').val() == '' && $('input[id=filters-site]').val() == '' && $('input[id=filters-host]').val() == '' ) )
                    {
                        alert("Please select a NGI Name OR a site Or a Host");
                        FormValid=false;
                    }





                    if (FormValid==true)
                    {

                        var baseview= 'site_status_report?';

                        if ($('input[id=filters-sf]').val()!='') {
                            baseview= 'sitesf_status_report?sf=' + $('input[id=filters-sf]').val();

                        }



                        if ($('input[id=filters-ngi]').val()!='')
                            view= baseview + '&ngi=' + $('input[id=filters-ngi]').val();

                        if ($('input[id=filters-site]').val()!='')
                            view= baseview + '&ngi=all&site=' + $('input[id=filters-site]').val();

                        if ($('input[id=filters-host]').val()!='') {

                            var host=$('input[id=filters-host]').val().split('  ');

                            view = 'metric_status_report?ngi='+ tabavailableHostNgi[host] +'&site=' + tabavailableHostSite[host] + '&sf=' +  tabavailableHostSf[host]  + '&host=' + tabavailableHostHost[host] ;

                        }




                        var range = $( ".range input:checked" ).val();
                        var profile = $( ".profile input:checked" ).val();

                        if (profile.search('cloud') > 1 ) {
                            range = range + '_cloud';
                        }

                        var link ='/lavoisier/'  + view  + '&data=' + range + '&profile=' + profile + '&accept=html' ;

                        window.location= link;

                    }

                });





            });



-->

        </script>


    </section>
    <!-- /.content -->

</aside>
<!-- /.right-side -->


</div>
</body>

<style type="text/css">
    .form-group label {
        margin-left:10px;
        width : 100px;

    }

</style>

</html>

