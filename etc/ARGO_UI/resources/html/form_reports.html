<!DOCTYPE html>
<html xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd"
      xmlns:tpl="http://software.in2p3.fr/lavoisier/template.xsd" tpl:extends="http://localhost:8080/lavoisier?accept=html">


<body>
<!-- Right side column. Contains the navbar and content of the page -->
<div id="wrapper">

<aside class="right-side" id="right-side">
    <!-- Content Header (Page header) -->
    <section class="content-header" id="content-header">
        <h1>
            Availabilities Reliabilities Reports
            <small>League Report</small>
        </h1>

    </section>

    <!-- Main content -->
    <section class="content" id="content">
        <div id="id_content" class="hidden"></div>


            <div class="box box-primary">

                <div class="row" style="margin:20px;padding:20px">

                    <div class="box  col-md-5" style="margin:20px;padding:20px;height:180px ">

                        <div class="box-header"><H3 class="box-title">Period</H3></div>
                        <div class="box-body">
                            <div class="row">

                                <label> <i class="fa fa-calendar"> </i>   Date range:</label>
                                <input  id="reportrange" type="text" /><span></span><br/>




                            </div><!-- /.input group -->


                        </div>
                    </div>



                    <div class="box  col-md-5 " style="margin:20px;padding:20px;height:180px ">

                        <div class="box-header"><H3 class="box-title">Entity</H3></div>

                        <div class="box-body">

                            <div class="form-group ">



                                <label>NGI </label>
                                <input type="text" style="margin-left:20px" name="ngi" id="filters-ngi" placeholder="Enter Search "/><br/>




                                <label>SITE </label>
                                <input type="text" style="margin-left:20px" name="site" id="filters-site" placeholder="Enter Search "/>


                            </div>
                        </div>
                    </div>



                    <div class="box  col-md-5 " style="margin:20px;padding:20px;height:180px ">

                        <div class="box-header"><H3 class="box-title">Profiles</H3></div>

                        <div class="box-body">

                            <div class="form-group ">



                               <select name="profile" id="profile">
                                   <option tpl:foreach="/root/profile" value="{{concat(@namespace,'-',@name)}}">{{concat(@namespace,'-',@name)}}</option>
                               </select>


                            </div>
                        </div>
                    </div>


                <div class="box  col-md-5 " style="margin:20px;padding:20px;height:180px ">

                    <div class="box-header"><H3 class="box-title">Granularity</H3></div>
                    <div class="box-body">
                        <div class="form_group">
                            <input type="radio" value="DAILY" name="granularity"
                                   id="granularity1" checked="true"/> DAILY
                            <input style="margin-left:20px" type="radio" value="MONTHLY" name="granularity"
                                   id="granularity2"/> MONTHLY
                        </div>
                    </div>
                </div>

                <div class="box   col-md-5" style="margin:20px;padding:20px;height:180px ;display:none">

                    <div class="box-header"><H3 style="margin-left:60px">Status</H3></div>

                    <div class="box-body">
                        <div class="form_group">
                            <input type="checkbox" checked="true" value="prod"/> PRODUCTION
                            <input style="margin-left:20px" type="checkbox" readonly="readonly" value="preprod"/> PRE-PRODUCTION
                        </div>
                    </div>

                </div>


                </div>

                <div class="row" style="margin:30px;padding:20px">
                    <input type="submit" class="btn btn-primary offset1" id="buttonAR" value="Generate Reports"/>
                </div>

            </div>


            <div class="hidden" id="listNgi" tpl:foreach="/root/ngis">{{text()}}</div>
        <div class="hidden" id="listSite" tpl:foreach="/root/sites">{{text()}}</div>



        <script src="/resource/ARGO_UI/resources/js/plugins/daterangepicker/daterangepicker.js" type="text/javascript"></script>


        <script>

            $(document).ready(function ($) {



                $('#reportrange').daterangepicker(
                        {
                            format: 'YYYY-MM-DD',
                            ranges: {
                                'Last 30 Days': [moment().subtract('days', 29), moment()],
                                'This Month': [moment().startOf('month'), moment().endOf('month')],
                                'Last Month': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')],
                                'Last 3 Months': [moment().subtract('month', 3).startOf('month'), moment().subtract('month', 1).endOf('month')],
                                'Last 6 Months': [moment().subtract('month', 6).startOf('month'), moment().subtract('month', 1).endOf('month')]
                            },
                            startDate: moment().subtract('days', 29),
                            endDate: moment()
                        }

                );

                <!-- Variable initialisation for the autocomplete -->
                var availableNgis = "ALL" + $("#listNgi").text();
                var availableSites =  "ALL" + $("#listSite").text();
                var tabavailableNgis=  availableNgis.split(',');
                var tabavailableSite= availableSites.split(',');

                $("#filters-ngi").autocomplete({
                    search:true,
                    source: tabavailableNgis,
                    TextHint : "Enter search or Double click to have the whole list"

                });

                $("#filters-site").autocomplete({
                    source: tabavailableSite,
                    autoFocus: true
                });




                <!-- date picker load -->




            });


            $("#buttonAR").click(function () {



                var FormValid=true;

                <!-- NGI or Site should be filled -->
                if ( ($('input[id=filters-ngi]').val()  &amp;&amp; $('input[id=filters-site]').val()) || ($('input[id=filters-ngi]').val() == '' &amp;&amp; $('input[id=filters-site]').val() == '' ) )
                {
                    alert("Please select a NGI Name OR a site");
                    FormValid=false;
                }



                if ( $('#reportrange').val()=='')
                {
                    alert("Please select a period for the report");
                    FormValid=false;
                }

                if (FormValid==true)
                {
                    var view='cloud_ar';

                    if ($('input[id=filters-ngi]').val()!='')
                        view= 'ngi_ar?ngi=' + $('input[id=filters-ngi]').val();

                    if ($('input[id=filters-site]').val()!='')
                        view= 'site_ar?site=' + $('input[id=filters-site]').val();

                    var range = 'start_date=' + $('#reportrange').val().replace(' - ','&amp;end_date=');



                    var link ='/lavoisier/'  + view  + '&amp;cr=1' + '&amp;' + range + '&amp;granularity='   +  $('input[name=granularity]:checked').val() + '&amp;profile=' +  $('#profile :selected').val();

                    window.location= link;

                }

            });



        </script>


    </section>
    <!-- /.content -->

</aside>
<!-- /.right-side -->


</div>
</body>

<style type="text/css">
    .form-group label {
        margin-left:10px;
        width : 100px;

    }

</style>

</html>

