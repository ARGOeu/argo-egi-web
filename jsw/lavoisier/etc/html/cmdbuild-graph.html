<html xmlns="http://www.w3.org/1999/xhtml" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd"
      xmlns:tpl="http://software.in2p3.fr/lavoisier/template.xsd" tpl:extends="/lavoisier/base?accept=html">
<head lang="en">
    <meta charset="UTF-8"/>
    <title>CMDBuild</title>
</head>
<body>
<div id="content" class="container">
    <h2 id="title" class="page-title text-center">Dependencies graph</h2>
    <form class="form-inline breadcrumb" action="/lavoisier/dependencies" method="GET" >
        <input type="hidden" name="class" tpl:value="/e:entries/@class"/>
        <input type="hidden" name="card" tpl:value="/e:entries/@id"/>
        <div tpl:foreach="/*/arguments/*" class="form-group" style="margin-left:20px">
            <label for="{local-name()}" tpl:text="local-name()">xxx</label>
            <select class="form-control" name="{local-name()}" tpl:copy-of="@multiple">
                <option value=" " selected="selected"> </option>
                <option tpl:foreach="option" value="{text()}" tpl:copy-of="@selected | text()"/>
            </select>
        </div>
        <input class="btn btn-primary pull-right" type="submit" value="Refresh" style="margin-top:20px"/>
    </form>

    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
        <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="headingOne">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                        <span class="glyphicon glyphicon-expand"></span> Details
                    </a>
                </h4>
            </div>
            <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="panel-body">
                    <table class="table table-bordered table-striped table-sorted table-hover">
                        <thead><tr><th>Name</th><th>Value</th></tr></thead>
                        <tbody>
                        <tr tpl:foreach="/e:entries/*[local-name()='attributes']/*">
                            <td tpl:text="local-name()">my key</td>
                            <td tpl:text="text()">my value</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script type="text/vnd.graphviz" id="dot" tpl:copy-of="/e:entries/e:entry/text()">digraph G {A->B;}</script>
    <script src="http://mdaines.github.io/viz.js/viz.js"></script>
<script>//<![CDATA[
function printStackTrace(s) {
    return "<pre>" + s.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\"/g, "&quot;") + "</pre>"
}
function toSVG() {
    graph = document.getElementById("dot").innerHTML;
    try {return Viz(graph, "svg", "neato");}
    catch(e) {return printStackTrace(e.toString() + graph);}
}
document.body.innerHTML += toSVG();
//]]></script>
</div>
</body>
</html>